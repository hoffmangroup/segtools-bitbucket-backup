{"links": {"self": {"href": "data/repositories/hoffmanlab/segtools/issues/24/comments/19239734.json"}, "html": {"href": "#!/hoffmanlab/segtools/issues/24#comment-19239734"}}, "issue": {"links": {"self": {"href": "data/repositories/hoffmanlab/segtools/issues/24.json"}}, "type": "issue", "id": 24, "repository": {"links": {"self": {"href": "data/repositories/hoffmanlab/segtools.json"}, "html": {"href": "#!/hoffmanlab/segtools"}, "avatar": {"href": "data/bytebucket.org/ravatar/{981b7f63-4900-4255-97c0-c244f833a3ee}ts=python"}}, "type": "repository", "name": "segtools", "full_name": "hoffmanlab/segtools", "uuid": "{981b7f63-4900-4255-97c0-c244f833a3ee}"}, "title": "R error: \"nlabels not found\" in version 1.1.9"}, "content": {"raw": "Tags were not preserved evidently on the transition from SVN to mercurial.\n\nThe last revision that I can find where track_statistics.R matches is with revision 176:14da4f546a76. There are 17 changes to track_statistics.R between then and now (the last being on 272:04cb7b8a3b7e).\n\nThe error comes from revision 223:17f5e3be0d57\n```shell\n$ hg log -r 223\nchangeset:   223:17f5e3be0d57\nuser:        Orion Buske <buske@cs.toronto.edu>\ndate:        Thu Oct 13 01:30:02 2011 +0000\nfiles:       segtools/R/track_statistics.R\ndescription:\nMade width specifiable in in track stats plotting\n\n$ hg diff -c 223 segtools/R/track_statistics.R\ndiff -r ad36e973f716 -r 17f5e3be0d57 segtools/R/track_statistics.R\n--- a/segtools/R/track_statistics.R     Wed Oct 12 17:17:27 2011 +0000\n+++ b/segtools/R/track_statistics.R     Thu Oct 13 01:30:02 2011 +0000\n@@ -567,7 +567,7 @@\n     col.ord <- match(label_order, colnames(means))\n     stopifnot(col.ord > 0, length(col.ord) == ncol(means))\n   }\n-  par(oma = c(1, 1, 1, 1))  # Add a margin\n+  #par(oma = c(1, 1, 1, 1))  # Add a margin\n\n   sds.ordered = NULL\n   if (! is.null(sds)) {\n@@ -627,6 +627,10 @@\n                              symmetric = FALSE,\n                              clobber = FALSE,\n                              square.size = 15,  # px\n+                             height = 200 + square.size * ntracks,\n+                             width = 450 + square.size * nlabels,\n+                             height.pdf = height / 72,\n+                             width.pdf = width / 72,\n                              ...) {\n   mnemonics <- read.mnemonics(mnemonic_file)\n   translations <- read.mnemonics(translation_file)\n@@ -637,13 +641,13 @@\n\n   ntracks <- nlevels(res$stats$trackname)\n   nlabels <- nlevels(res$stats$label)\n-  height <- 200 + square.size * ntracks\n-  width <- 450 + square.size * nlabels\n-\n+\n   save.images(dirpath, namebase,\n               levelplot.track.stats(res, symmetric = symmetric, ...),\n               height = height,\n               width = width,\n+              height.pdf = height.pdf,\n+              width.pdf = width.pdf,\n               clobber = clobber)\n }\n```\n\nEssentially the defined width/height parameters were copy pasted into the parameters probably not realizing that using nlabels in the default parameters was a bad idea. There's a good chance it was never caught if the function was always called with non-default width and height parameters.\n\nThis was never fixed in later histories (and then accidentally reverted).\n\nIt does raise the question as to what the default width/height parameters should be.", "markup": "markdown", "html": "<p>Tags were not preserved evidently on the transition from SVN to mercurial.</p>\n<p>The last revision that I can find where track_statistics.R matches is with revision 176:<a href=\"#!/hoffmanlab/segtools/commits/14da4f546a76\" rel=\"nofollow\" class=\"ap-connect-link\">14da4f546a76</a>. There are 17 changes to track_statistics.R between then and now (the last being on 272:<a href=\"#!/hoffmanlab/segtools/commits/04cb7b8a3b7e\" rel=\"nofollow\" class=\"ap-connect-link\">04cb7b8a3b7e</a>).</p>\n<p>The error comes from revision 223:<a href=\"#!/hoffmanlab/segtools/commits/17f5e3be0d57\" rel=\"nofollow\" class=\"ap-connect-link\">17f5e3be0d57</a></p>\n<div class=\"codehilite language-shell\"><pre><span></span>$ hg log -r <span class=\"m\">223</span>\nchangeset:   <span class=\"m\">223</span>:17f5e3be0d57\nuser:        Orion Buske &lt;buske@cs.toronto.edu&gt;\ndate:        Thu Oct <span class=\"m\">13</span> <span class=\"m\">01</span>:30:02 <span class=\"m\">2011</span> +0000\nfiles:       segtools/R/track_statistics.R\ndescription:\nMade width specifiable in in track stats plotting\n\n$ hg diff -c <span class=\"m\">223</span> segtools/R/track_statistics.R\ndiff -r ad36e973f716 -r 17f5e3be0d57 segtools/R/track_statistics.R\n--- a/segtools/R/track_statistics.R     Wed Oct <span class=\"m\">12</span> <span class=\"m\">17</span>:17:27 <span class=\"m\">2011</span> +0000\n+++ b/segtools/R/track_statistics.R     Thu Oct <span class=\"m\">13</span> <span class=\"m\">01</span>:30:02 <span class=\"m\">2011</span> +0000\n@@ -567,7 +567,7 @@\n     col.ord &lt;- match<span class=\"o\">(</span>label_order, colnames<span class=\"o\">(</span>means<span class=\"o\">))</span>\n     stopifnot<span class=\"o\">(</span>col.ord &gt; <span class=\"m\">0</span>, length<span class=\"o\">(</span>col.ord<span class=\"o\">)</span> <span class=\"o\">==</span> ncol<span class=\"o\">(</span>means<span class=\"o\">))</span>\n   <span class=\"o\">}</span>\n-  par<span class=\"o\">(</span><span class=\"nv\">oma</span> <span class=\"o\">=</span> c<span class=\"o\">(</span><span class=\"m\">1</span>, <span class=\"m\">1</span>, <span class=\"m\">1</span>, <span class=\"m\">1</span><span class=\"o\">))</span>  <span class=\"c1\"># Add a margin</span>\n+  <span class=\"c1\">#par(oma = c(1, 1, 1, 1))  # Add a margin</span>\n\n   sds.ordered <span class=\"o\">=</span> NULL\n   <span class=\"k\">if</span> <span class=\"o\">(</span>! is.null<span class=\"o\">(</span>sds<span class=\"o\">))</span> <span class=\"o\">{</span>\n@@ -627,6 +627,10 @@\n                              <span class=\"nv\">symmetric</span> <span class=\"o\">=</span> FALSE,\n                              <span class=\"nv\">clobber</span> <span class=\"o\">=</span> FALSE,\n                              square.size <span class=\"o\">=</span> <span class=\"m\">15</span>,  <span class=\"c1\"># px</span>\n+                             <span class=\"nv\">height</span> <span class=\"o\">=</span> <span class=\"m\">200</span> + square.size * ntracks,\n+                             <span class=\"nv\">width</span> <span class=\"o\">=</span> <span class=\"m\">450</span> + square.size * nlabels,\n+                             height.pdf <span class=\"o\">=</span> height / <span class=\"m\">72</span>,\n+                             width.pdf <span class=\"o\">=</span> width / <span class=\"m\">72</span>,\n                              ...<span class=\"o\">)</span> <span class=\"o\">{</span>\n   mnemonics &lt;- read.mnemonics<span class=\"o\">(</span>mnemonic_file<span class=\"o\">)</span>\n   translations &lt;- read.mnemonics<span class=\"o\">(</span>translation_file<span class=\"o\">)</span>\n@@ -637,13 +641,13 @@\n\n   ntracks &lt;- nlevels<span class=\"o\">(</span>res<span class=\"nv\">$stats$trackname</span><span class=\"o\">)</span>\n   nlabels &lt;- nlevels<span class=\"o\">(</span>res<span class=\"nv\">$stats$label</span><span class=\"o\">)</span>\n-  height &lt;- <span class=\"m\">200</span> + square.size * ntracks\n-  width &lt;- <span class=\"m\">450</span> + square.size * nlabels\n-\n+\n   save.images<span class=\"o\">(</span>dirpath, namebase,\n               levelplot.track.stats<span class=\"o\">(</span>res, <span class=\"nv\">symmetric</span> <span class=\"o\">=</span> symmetric, ...<span class=\"o\">)</span>,\n               <span class=\"nv\">height</span> <span class=\"o\">=</span> height,\n               <span class=\"nv\">width</span> <span class=\"o\">=</span> width,\n+              height.pdf <span class=\"o\">=</span> height.pdf,\n+              width.pdf <span class=\"o\">=</span> width.pdf,\n               <span class=\"nv\">clobber</span> <span class=\"o\">=</span> clobber<span class=\"o\">)</span>\n <span class=\"o\">}</span>\n</pre></div>\n\n\n<p>Essentially the defined width/height parameters were copy pasted into the parameters probably not realizing that using nlabels in the default parameters was a bad idea. There's a good chance it was never caught if the function was always called with non-default width and height parameters.</p>\n<p>This was never fixed in later histories (and then accidentally reverted).</p>\n<p>It does raise the question as to what the default width/height parameters should be.</p>", "type": "rendered"}, "created_on": "2015-06-23T19:29:53.266689+00:00", "user": {"display_name": "Eric Roberts", "uuid": "{cd8c1fe0-28ca-45fb-8ef9-48090b42bb80}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bcd8c1fe0-28ca-45fb-8ef9-48090b42bb80%7D"}, "html": {"href": "https://bitbucket.org/%7Bcd8c1fe0-28ca-45fb-8ef9-48090b42bb80%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/17548d71dfb29d015b880f48cfc01ca3d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsER-5.png"}}, "nickname": "ericr86", "type": "user", "account_id": "557058:c80ca578-03a1-4ac6-b3ee-50372a3fceee"}, "updated_on": "2015-06-23T19:30:22.114357+00:00", "type": "issue_comment", "id": 19239734}